---
title: React Hooks 实现原理
categories:
 - React
tags:
 - React源码
 - 源码
---

# React Hooks 实现原理

## 相关数据结构

* fiber
```js
type Fiber {

  memoizedState: null, // Hooks 链表

  stateNode: null, // 组件本身
}
```

* Hook

```ts
type Hook {
  memoizedState: any,   // 保存当前计算出来的state
  baseState: any,
  baseQueue: Update<any, any> | null,
  queue: UpdateQueue<any, any> | null,
  next: Hook | null,
}
```

* UpdateQueue
  
```ts
type UpdateQueue<S, A> = {|
  pending: Update<S, A> | null,
  dispatch: (A => mixed) | null,
  lastRenderedReducer: ((S, A) => S) | null,
  lastRenderedState: S | null,
|};
```

